1. 实现负载均衡这个功能其实是Nginx自带的upstream模块

2. 语法
```nginx.conf
#-->web1是负载均衡组的名称，负载均衡组要定义在server模块之外
upstream  web1  {    
#-->负载均衡算法
           ip_hash;  
           #-->    网站地址    权重为1  最多错误(链接不上)几次    每次检查持续时间
           server  192.168.1.1   weight=1  max_fails=2     fail_timeout=2；
           
           server 192.168.1.2  weight=1  max_fails=2  fail_timeout=2；   
           server  127.0.0.1:8080  backup;   
           #-->    备用地址 
           #若前面server定义的几台后端服务器都无法工作，则使用backup标注的这台服务器
}     
           
server {
        listen       80;
        server_name  localhost;

	location  /  {
		#-->反向代理，这里webserver要改为upstream组名 , 这里是
         proxy_pass  http://webserver/;   
        }
}
```

3. 负载均衡算法(ip_hash不能与backup同时使用，且当有服务器需要剔除掉时，必须手动down掉。)
	- 轮询（round-robin）：Nginx默认的负载均衡策略。所有的请求按照时间顺序轮流分配到后端服务器上，可以均衡地将用户请求分散到各个后端服务器上，但是并不关心后端服务器的连接数和系统负载
	- 源地址哈希（ip_hash）：指定负载均衡器按照基于客户端IP的分配方式，通过对IP的hash值进行计算从而选择分配的服务器。简单来讲就是将来自于同一个客户端的请求始终定向到同一个服务器。这是这种算法的一个重要特点，能保证session会话的维持(若无法保持session会话，当用户关闭已登录成功的网站页面，再重新打开时，该用户就不是登录状态了，需要再重新输入账号密码进行登录)
	- 最小连接数（least-conn）：将下一个请求分配到拥有最少活动连接数的后端服务器中。轮询是把用户请求平均分配给各个后端服务器，使它们的负载大致相同。但是有些请求占用的时间很长，会导致其所在的后端负载较高。在这种情况下，least_conn算法可以实现更好的负载均衡效果
	- 加权轮询（weight）：在轮询算法的基础上指定轮询的概率。权重越高被分配的机率越大，适合服务器硬件性能存在一定差距的情况
	- 响应时间（fair）：按照服务器端的响应时间来分配请求，响应时间短的优先分配
	- url分配（url_hash）：按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，要配合缓存命中来使用。若同一个资源多次请求，可能会到达不同的服务器上，导致不必要的多次下载，缓存命中率不高和下载资源消耗时间的浪费。而使用url_hash算法，可以使得同一个url（也就是同一个资源请求）到达同一台服务器，一旦缓存了资源，再次收到相同请求，就可以直接在缓存中读取